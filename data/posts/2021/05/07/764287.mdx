---
title: Learn Rust with Tests (0)　Rust入門
tags: ['rust', 'tdd']
date: '2021-05-07T12:20:52.146Z'
---

テスト駆動でRustを学習しようという取り組みです.
<!-- seq -->

そのためにまずはプロジェクトをどのように構成するか考える必要があります.

## Rustでテストを書くには?

Rustのパッケージ・マネジャであるCargoはtestサブコマンドでテストをそもそも実行できます.
なので問題になるのはプロジェクトの構成ぐらいでしょうか?

## 用語

まず用語を整理しておきましょう.

### クレートとパッケージ

[Packages and Crates](https://doc.rust-lang.org/book/ch07-01-packages-and-crates.html)によると, それぞれ以下のように定義されています.

> A crate is a binary or library.

> A package is one or more crates that provide a set of functionality. A package contains a Cargo.toml file that describes how to build those crates.

cargo-newコマンドはデフォルトでbinクレートを一つ含むRustパッケージを生成します. 生成されたプロジェクトにはCargo.tomlが一つ含まれています.

### ターゲットとパッケージとは?

[Cargo Targets](https://doc.rust-lang.org/cargo/reference/cargo-targets.html)によると,

> Cargo packages consist of targets which correspond to source files which can be compiled into a crate. 

クレートとしてコンパイルされるのがターゲットとされているようです. lib.rsならライブラリ・ターゲットになります.

> Packages can have library, binary, example, test, and benchmark targets. 

これが[Package Layout](https://doc.rust-lang.org/cargo/guide/project-layout.html)で示されたファイル階層と対応します. main.rsやlib.rs以外にもexamples, tests, そしてbenchesといったフォルダがありそれぞれターゲットが生成されるようです.

このレイアウトはあくまで基本的な構成で、Cargo.tomlの対応するセクションで指定することもできます.

[Configuring a target](https://doc.rust-lang.org/cargo/reference/cargo-targets.html#configuring-a-target)を見ると細かい設定項目が書いています.

マニフェストの項目は[The Manifest Format](https://doc.rust-lang.org/cargo/reference/manifest.html)のTarget tablesで確認できます. 

### モジュールとは?

巨大化したプログラムを分割して管理する方法です. modキーワードを使って定義します. モジュール内部で定義されたソフトウェア・コンポーネントは

[Managing Growing Projects with Packages, Crates, and Modules](https://doc.rust-lang.org/book/ch07-00-managing-growing-projects-with-packages-crates-and-modules.html#managing-growing-projects-with-packages-crates-and-modules)

### featuresとは？

### Workspaceとは?

## cargo-test

## References

- [How to organize tests in Rust?](https://sireliah.com/niusy/testing_in_rust/)
- [Split a module across several files](https://stackoverflow.com/questions/22596920/split-a-module-across-several-files)
- [Unit testing](https://doc.rust-lang.org/rust-by-example/testing/unit_testing.html)
- [Tests -Cargo Book](https://doc.rust-lang.org/cargo/guide/tests.html)
- [Writing Automated Tests](https://doc.rust-lang.org/book/ch11-00-testing.html)
- [Glossary - Cargo Book](https://doc.rust-lang.org/cargo/appendix/glossary.html?highlight=member#workspace)